<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO -->
    <title>Privacy Center ‚Äî Community Card Showcase</title>
    <meta name="description"
        content="Manage your data, review privacy settings, export or delete your data, and view the security audit for the Community Card Showcase platform.">
    <meta name="robots" content="noindex">

    <!-- Icons & Fonts -->
    <link rel="icon" href="assets/favicon/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/security-manager.css">
    <link rel="stylesheet" href="css/privacy-policy.css">

    <style>
        /* Page-specific overrides */
        body {
            font-family: 'Inter', sans-serif;
            background: #0a0f1e;
            color: #e2e8f0;
            min-height: 100vh;
        }

        /* Subtle starfield background */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                radial-gradient(circle at 20% 30%, rgba(79, 142, 247, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(34, 211, 165, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        main {
            position: relative;
            z-index: 1;
        }

        .page-home .nav-links a[href="privacy-center.html"] {
            color: #4fd1ff;
            font-weight: 600;
        }

        /* Privacy status indicator in paragraph */
        .status-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
        }

        .status-pill.active {
            background: rgba(34, 211, 165, 0.12);
            color: #22d3a5;
            border: 1px solid rgba(34, 211, 165, 0.25);
        }

        .status-pill.inactive {
            background: rgba(148, 163, 184, 0.08);
            color: #64748b;
            border: 1px solid rgba(148, 163, 184, 0.15);
        }

        /* Last updated footer */
        .pc-footer-note {
            text-align: center;
            color: #475569;
            font-size: 0.8rem;
            padding: 2rem 0;
            border-top: 1px solid rgba(148, 163, 184, 0.08);
            max-width: 1200px;
            margin: 0 auto;
            padding-inline: 1.5rem;
        }
    </style>
</head>

<body data-theme="ocean">

    <!-- Cursor trail (same as other pages) -->
    <div class="circle-container">
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
    </div>

    <!-- ‚îÄ‚îÄ NAVBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <nav class="navbar">
        <div class="nav-logo">üöÄ Community</div>

        <div class="hamburger" id="hamburger">
            <span></span><span></span><span></span>
        </div>

        <ul class="nav-links" id="navLinks">
            <li><a href="index.html">Home</a></li>
            <li><a href="contribute.html">Contribute</a></li>
            <li><a href="projects.html">Projects</a></li>
            <li>
                <a href="https://github.com/Jayanta2004/dev-card-showcase" target="_blank" rel="noopener">GitHub</a>
            </li>
            <li class="dropdown">
                <button class="drop-btn">More ‚ñæ</button>
                <ul class="dropdown-menu">
                    <li><a href="about.html">About</a></li>
                    <li><a href="faq.html">FAQ</a></li>
                    <li><a href="privacy-center.html" style="color:#4fd1ff;font-weight:600">üîí Privacy Center</a></li>
                    <li><a href="privacy-policy.html">Privacy Policy</a></li>
                </ul>
            </li>
        </ul>

        <div class="theme-switcher" role="group" aria-label="Theme switcher">
            <button class="theme-option" data-theme="ocean" aria-pressed="true">
                <span class="swatch ocean"></span> Ocean
            </button>
            <button class="theme-option" data-theme="neon" aria-pressed="false">
                <span class="swatch neon"></span> Neon
            </button>
            <button class="theme-option" data-theme="minimal" aria-pressed="false">
                <span class="swatch minimal"></span> Minimal
            </button>
        </div>
    </nav>

    <!-- ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <main>

        <!-- Hero -->
        <section class="privacy-center-hero">
            <div class="privacy-hero-shield" aria-hidden="true">üîê</div>
            <h1>Privacy Center</h1>
            <p>
                Full transparency and control over your data.
                Everything stored on-device, never sent to external servers.
                <span id="encStatusBadge" class="status-pill active" style="margin-left:.5rem">
                    <span class="dcs-status-dot"></span> Encryption Active
                </span>
            </p>
        </section>

        <!-- Cards Grid -->
        <div class="privacy-center-grid" id="privacyCenterGrid">

            <!-- ‚ë† Consent & Permissions ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
            <div class="sec-card">
                <div class="sec-card-header">
                    <div class="sec-card-icon sec-icon-blue">üõ°Ô∏è</div>
                    <div>
                        <h2 class="sec-card-title">Consent & Permissions</h2>
                        <p class="sec-card-subtitle">Control what data the platform may use</p>
                    </div>
                </div>

                <div id="permissionRows">
                    <!-- Rendered by JS -->
                    <div class="perm-row">
                        <div class="perm-info">
                            <h4>Essential Storage</h4>
                            <p>Theme, view preferences ‚Äî required for basic functionality</p>
                        </div>
                        <label class="dcs-toggle-label">
                            <input type="checkbox" id="perm-storage" checked disabled>
                            <span class="dcs-toggle-track"><span class="dcs-toggle-thumb"></span></span>
                        </label>
                    </div>

                    <div class="perm-row">
                        <div class="perm-info">
                            <h4>Analytics</h4>
                            <p>Contributor stats, feature usage ‚Äî stored locally only</p>
                        </div>
                        <label class="dcs-toggle-label">
                            <input type="checkbox" id="perm-analytics">
                            <span class="dcs-toggle-track"><span class="dcs-toggle-thumb"></span></span>
                        </label>
                    </div>

                    <div class="perm-row">
                        <div class="perm-info">
                            <h4>Geolocation</h4>
                            <p>Optional location-aware features (weather, local data)</p>
                        </div>
                        <label class="dcs-toggle-label">
                            <input type="checkbox" id="perm-geo">
                            <span class="dcs-toggle-track"><span class="dcs-toggle-thumb"></span></span>
                        </label>
                    </div>

                    <div class="perm-row">
                        <div class="perm-info">
                            <h4>Notifications</h4>
                            <p>Browser notifications for events and reminders</p>
                        </div>
                        <label class="dcs-toggle-label">
                            <input type="checkbox" id="perm-notifications">
                            <span class="dcs-toggle-track"><span class="dcs-toggle-thumb"></span></span>
                        </label>
                    </div>
                </div>

                <div class="sec-save-row">
                    <button id="saveConsentBtn" class="dcs-btn dcs-btn-primary">
                        <i class="fas fa-save" style="margin-right:.4rem"></i> Save Preferences
                    </button>
                </div>
            </div>

            <!-- ‚ë° Storage Monitor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
            <div class="sec-card">
                <div class="sec-card-header">
                    <div class="sec-card-icon sec-icon-green">üíæ</div>
                    <div>
                        <h2 class="sec-card-title">Storage Monitor</h2>
                        <p class="sec-card-subtitle">Local data usage and encryption status</p>
                    </div>
                </div>

                <div class="storage-meter">
                    <div class="storage-bar-track">
                        <div class="storage-bar-fill" id="storageBarFill" style="width:0%"></div>
                    </div>
                    <div class="storage-stats">
                        <span id="storageUsedKB">Calculating‚Ä¶</span>
                        <span id="storageMaxKB">/ 2048 KB</span>
                    </div>
                </div>

                <div class="privacy-section-label">Stored Keys</div>
                <div class="storage-key-list" id="storageKeyList">
                    <p style="color:#475569;font-size:.8rem;padding:.5rem">Loading storage inventory‚Ä¶</p>
                </div>
            </div>

            <!-- ‚ë¢ Security Audit ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
            <div class="sec-card">
                <div class="sec-card-header">
                    <div class="sec-card-icon sec-icon-yellow">üîç</div>
                    <div>
                        <h2 class="sec-card-title">Security Audit</h2>
                        <p class="sec-card-subtitle">Real-time checks against best practices</p>
                    </div>
                </div>
                <div id="auditChecklist">
                    <p style="color:#475569;font-size:.8rem;padding:.5rem">Running checks‚Ä¶</p>
                </div>
                <div class="sec-save-row">
                    <button id="rerunAuditBtn" class="dcs-btn dcs-btn-secondary">
                        <i class="fas fa-sync-alt" style="margin-right:.4rem"></i> Re-run Audit
                    </button>
                </div>
            </div>

            <!-- ‚ë£ Data Portability ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
            <div class="sec-card">
                <div class="sec-card-header">
                    <div class="sec-card-icon sec-icon-cyan">üì¶</div>
                    <div>
                        <h2 class="sec-card-title">Your Data</h2>
                        <p class="sec-card-subtitle">Export, review, or permanently delete your data</p>
                    </div>
                </div>

                <div class="data-action-row">
                    <div class="data-action-info">
                        <h4>Export My Data</h4>
                        <p>Download a JSON file with all locally stored data</p>
                    </div>
                    <button id="exportDataBtn" class="data-action-btn dcs-btn dcs-btn-secondary">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>

                <div class="data-action-row">
                    <div class="data-action-info">
                        <h4>Revoke All Consent</h4>
                        <p>Reset your privacy choices ‚Äî banner will reappear</p>
                    </div>
                    <button id="revokeConsentBtn" class="data-action-btn dcs-btn dcs-btn-ghost">
                        <i class="fas fa-undo"></i> Revoke
                    </button>
                </div>

                <div class="data-action-row">
                    <div class="data-action-info">
                        <h4><span style="color:#ef4444">‚ö†Ô∏è Reset My Data</span></h4>
                        <p>Permanently delete ALL locally stored data. This cannot be undone.</p>
                    </div>
                    <button id="resetDataBtn" class="data-action-btn dcs-btn dcs-btn-danger">
                        <i class="fas fa-trash-alt"></i> Reset
                    </button>
                </div>
            </div>

            <!-- ‚ë§ What We Store ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
            <div class="sec-card">
                <div class="sec-card-header">
                    <div class="sec-card-icon sec-icon-purple">üìú</div>
                    <div>
                        <h2 class="sec-card-title">What We Store & Why</h2>
                        <p class="sec-card-subtitle">Full transparency on each data category</p>
                    </div>
                </div>

                <table style="width:100%;border-collapse:collapse;font-size:.8rem;color:#94a3b8">
                    <thead>
                        <tr style="color:#e2e8f0;text-align:left;border-bottom:1px solid rgba(148,163,184,.12)">
                            <th style="padding:.5rem .4rem;font-weight:600">Key</th>
                            <th style="padding:.5rem .4rem;font-weight:600">Purpose</th>
                            <th style="padding:.5rem .4rem;font-weight:600;text-align:center">Enc.</th>
                            <th style="padding:.5rem .4rem;font-weight:600">Retention</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom:1px solid rgba(148,163,184,.06)">
                            <td style="padding:.5rem .4rem;font-family:monospace;font-size:.73rem">theme</td>
                            <td style="padding:.5rem .4rem">Site colour theme preference</td>
                            <td style="padding:.5rem .4rem;text-align:center">‚úó</td>
                            <td style="padding:.5rem .4rem">Until cleared</td>
                        </tr>
                        <tr style="border-bottom:1px solid rgba(148,163,184,.06)">
                            <td style="padding:.5rem .4rem;font-family:monospace;font-size:.73rem">viewMode</td>
                            <td style="padding:.5rem .4rem">Grid / list view layout</td>
                            <td style="padding:.5rem .4rem;text-align:center;color:#22d3a5">üîí</td>
                            <td style="padding:.5rem .4rem">Until cleared</td>
                        </tr>
                        <tr style="border-bottom:1px solid rgba(148,163,184,.06)">
                            <td style="padding:.5rem .4rem;font-family:monospace;font-size:.73rem">devCardSpotlight</td>
                            <td style="padding:.5rem .4rem">Daily featured contributor</td>
                            <td style="padding:.5rem .4rem;text-align:center;color:#22d3a5">üîí</td>
                            <td style="padding:.5rem .4rem">1 day</td>
                        </tr>
                        <tr style="border-bottom:1px solid rgba(148,163,184,.06)">
                            <td style="padding:.5rem .4rem;font-family:monospace;font-size:.73rem">spotlightDate</td>
                            <td style="padding:.5rem .4rem">Most-recent spotlight refresh date</td>
                            <td style="padding:.5rem .4rem;text-align:center">‚úó</td>
                            <td style="padding:.5rem .4rem">1 day</td>
                        </tr>
                        <tr>
                            <td style="padding:.5rem .4rem;font-family:monospace;font-size:.73rem">_dcs_consent_</td>
                            <td style="padding:.5rem .4rem">Privacy consent choices</td>
                            <td style="padding:.5rem .4rem;text-align:center">‚úó</td>
                            <td style="padding:.5rem .4rem">Until revoked</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- ‚ë• Encryption Info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
            <div class="sec-card">
                <div class="sec-card-header">
                    <div class="sec-card-icon sec-icon-green">üîë</div>
                    <div>
                        <h2 class="sec-card-title">Encryption Details</h2>
                        <p class="sec-card-subtitle">How your sensitive data is protected</p>
                    </div>
                </div>

                <ul style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.75rem">
                    <li style="display:flex;align-items:flex-start;gap:.75rem">
                        <span style="color:#22d3a5;font-size:1.1rem;margin-top:.05rem">‚úì</span>
                        <div>
                            <strong style="color:#e2e8f0;font-size:.85rem">AES-GCM 256-bit</strong>
                            <p style="color:#64748b;font-size:.76rem;margin:.15rem 0 0">
                                Industry-standard authenticated encryption ‚Äî same used by TLS.
                            </p>
                        </div>
                    </li>
                    <li style="display:flex;align-items:flex-start;gap:.75rem">
                        <span style="color:#22d3a5;font-size:1.1rem;margin-top:.05rem">‚úì</span>
                        <div>
                            <strong style="color:#e2e8f0;font-size:.85rem">Per-session random key</strong>
                            <p style="color:#64748b;font-size:.76rem;margin:.15rem 0 0">
                                A fresh 256-bit key is generated each browser session via PBKDF2 + random salt.
                            </p>
                        </div>
                    </li>
                    <li style="display:flex;align-items:flex-start;gap:.75rem">
                        <span style="color:#22d3a5;font-size:1.1rem;margin-top:.05rem">‚úì</span>
                        <div>
                            <strong style="color:#e2e8f0;font-size:.85rem">Web Crypto API (native)</strong>
                            <p style="color:#64748b;font-size:.76rem;margin:.15rem 0 0">
                                No third-party crypto libraries ‚Äî uses the browser's native crypto.subtle.
                            </p>
                        </div>
                    </li>
                    <li style="display:flex;align-items:flex-start;gap:.75rem">
                        <span style="color:#22d3a5;font-size:1.1rem;margin-top:.05rem">‚úì</span>
                        <div>
                            <strong style="color:#e2e8f0;font-size:.85rem">Zero server transmission</strong>
                            <p style="color:#64748b;font-size:.76rem;margin:.15rem 0 0">
                                Data never leaves your device ‚Äî no APIs, no cloud sync, no tracking.
                            </p>
                        </div>
                    </li>
                    <li style="display:flex;align-items:flex-start;gap:.75rem" id="httpsFlagLi">
                        <span style="color:#f59e0b;font-size:1.1rem;margin-top:.05rem">‚ö†</span>
                        <div>
                            <strong style="color:#e2e8f0;font-size:.85rem">HTTPS required for encryption</strong>
                            <p style="color:#64748b;font-size:.76rem;margin:.15rem 0 0">
                                Web Crypto API is only available in secure contexts (HTTPS or localhost).
                            </p>
                        </div>
                    </li>
                </ul>
            </div>

        </div><!-- /grid -->

        <!-- Footer note -->
        <p class="pc-footer-note">
            üîí All data is stored exclusively on your device.
            This platform does not use cookies, analytics services, or external tracking.
            <a href="privacy-policy.html" style="color:#4f8ef7;text-decoration:none">Read full Privacy Policy ‚Üí</a>
        </p>

    </main>

    <!-- ‚îÄ‚îÄ RESET CONFIRMATION MODAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div id="dcs-reset-modal" style="display:none" class="dcs-modal-overlay" role="dialog" aria-modal="true"
        aria-labelledby="resetModalTitle">
        <div class="dcs-modal">
            <div class="dcs-modal-icon">üóëÔ∏è</div>
            <h3 id="resetModalTitle">Delete All Data?</h3>
            <p>
                This will permanently remove all locally stored data including preferences,
                the featured contributor, and consent choices.
                <strong style="color:#ef4444">This action cannot be undone.</strong>
            </p>
            <div class="dcs-modal-actions">
                <button id="confirmResetBtn" class="dcs-btn dcs-btn-danger">
                    <i class="fas fa-trash-alt"></i> Yes, Delete Everything
                </button>
                <button id="cancelResetBtn" class="dcs-btn dcs-btn-ghost">Cancel</button>
            </div>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ Scroll to top ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <button id="scrollToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" style="position:fixed;bottom:2rem;right:5.5rem;z-index:999;
                 width:44px;height:44px;border-radius:50%;border:none;
                 background:rgba(79,142,247,.15);color:#4f8ef7;
                 font-size:1.1rem;cursor:pointer;display:none;
                 align-items:center;justify-content:center;
                 box-shadow:0 4px 15px rgba(0,0,0,.3);
                 transition:all .3s ease;" title="Scroll to top" aria-label="Scroll to top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- ‚îÄ‚îÄ SCRIPTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <!-- Security Manager must load first -->
    <script src="js/security-manager.js"></script>

    <script>
        /* ‚îÄ‚îÄ Privacy Center Controller ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        document.addEventListener('DOMContentLoaded', async () => {

            const SM = window.SecurityManager;

            /* Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            function showToast(msg, type = 'info') {
                const t = document.createElement('div');
                t.className = `dcs-toast dcs-toast-${type}`;
                const icons = { success: '‚úÖ', error: '‚ùå', info: '‚ÑπÔ∏è' };
                t.innerHTML = `<span>${icons[type] || '‚ÑπÔ∏è'}</span> ${msg}`;
                document.body.appendChild(t);
                setTimeout(() => {
                    t.classList.add('exit');
                    setTimeout(() => t.remove(), 400);
                }, 3200);
            }

            /* ‚ë† Load & render consent toggles ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            function renderConsentToggles() {
                const c = SM.consent.getConsent();
                document.getElementById('perm-analytics').checked = c.analytics;
                document.getElementById('perm-geo').checked = c.geolocation;
                document.getElementById('perm-notifications').checked = c.notifications;
            }
            renderConsentToggles();

            document.getElementById('saveConsentBtn').addEventListener('click', () => {
                SM.consent.updateConsent({
                    analytics: document.getElementById('perm-analytics').checked,
                    geolocation: document.getElementById('perm-geo').checked,
                    notifications: document.getElementById('perm-notifications').checked,
                    storage: true
                });
                showToast('Privacy preferences saved!', 'success');
            });

            /* ‚ë° Storage monitor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            function renderStorage() {
                const inv = SM.storage.getInventory();
                const pct = Math.min(100, Math.round((inv.totalKB / inv.maxKB) * 100));
                const fill = document.getElementById('storageBarFill');
                const used = document.getElementById('storageUsedKB');
                const maxEl = document.getElementById('storageMaxKB');

                fill.style.width = `${pct}%`;
                if (pct > 80) fill.style.background = 'linear-gradient(90deg,#f59e0b,#ef4444)';
                used.textContent = `${inv.totalKB} KB used (${pct}%)`;
                maxEl.textContent = `/ ${inv.maxKB} KB`;

                const list = document.getElementById('storageKeyList');
                if (inv.keys.length === 0) {
                    list.innerHTML = '<p style="color:#475569;font-size:.8rem;padding:.5rem">No data stored yet.</p>';
                    return;
                }
                list.innerHTML = inv.keys.map(k => `
          <div class="storage-key-item">
            <span class="storage-key-name">${escHTML(k.key)}</span>
            <span class="storage-key-meta">
              <span style="color:#64748b">${k.size} KB ¬∑ ${k.age}d ago</span>
              ${k.encrypted ? '<span class="enc-badge">üîí enc</span>' : ''}
            </span>
          </div>
        `).join('');
            }
            renderStorage();

            /* ‚ë¢ Audit checklist ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            function renderAudit() {
                const checks = SM.audit.runChecks();
                const container = document.getElementById('auditChecklist');
                container.innerHTML = checks.map(c => `
          <div class="audit-item">
            <span class="audit-status ${c.pass ? 'audit-pass' : 'audit-warn'}">
              ${c.pass ? '‚úì' : '!'}
            </span>
            <div class="audit-item-text">
              <h4>${escHTML(c.label)}</h4>
              <p>${escHTML(c.note)}</p>
            </div>
          </div>
        `).join('');
            }
            renderAudit();

            document.getElementById('rerunAuditBtn').addEventListener('click', () => {
                renderAudit();
                showToast('Audit complete!', 'info');
            });

            /* ‚ë£ HTTPS encryption badge ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            if (!window.isSecureContext) {
                const badge = document.getElementById('encStatusBadge');
                badge.className = 'status-pill inactive';
                badge.innerHTML = '‚ö†Ô∏è Encryption Unavailable (HTTP)';
                // Update the HTTPS checklist item
                document.getElementById('httpsFlagLi').querySelector('span').textContent = '‚úó';
                document.getElementById('httpsFlagLi').querySelector('span').style.color = '#ef4444';
            } else {
                document.getElementById('httpsFlagLi').querySelector('span').textContent = '‚úì';
                document.getElementById('httpsFlagLi').querySelector('span').style.color = '#22d3a5';
            }

            /* ‚ë§ Export data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            document.getElementById('exportDataBtn').addEventListener('click', () => {
                SM.portability.exportData();
                showToast('Data exported successfully!', 'success');
            });

            /* ‚ë• Revoke consent ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            document.getElementById('revokeConsentBtn').addEventListener('click', () => {
                SM.consent.revokeAll();
                renderConsentToggles();
                showToast('Consent revoked. The banner will reappear next visit.', 'info');
            });

            /* ‚ë¶ Reset all data (with modal) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            const resetModal = document.getElementById('dcs-reset-modal');
            const confirmReset = document.getElementById('confirmResetBtn');
            const cancelReset = document.getElementById('cancelResetBtn');

            document.getElementById('resetDataBtn').addEventListener('click', () => {
                resetModal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            });

            cancelReset.addEventListener('click', () => {
                resetModal.style.display = 'none';
                document.body.style.overflow = '';
            });

            confirmReset.addEventListener('click', () => {
                SM.portability.resetMyData();
                resetModal.style.display = 'none';
                document.body.style.overflow = '';
                renderStorage();
                renderConsentToggles();
                showToast('All data deleted. Starting fresh üßπ', 'success');
            });

            resetModal.addEventListener('click', e => {
                if (e.target === resetModal) {
                    resetModal.style.display = 'none';
                    document.body.style.overflow = '';
                }
            });

            /* Scroll-to-top button */
            const stb = document.getElementById('scrollToTop');
            window.addEventListener('scroll', () => {
                stb.style.display = window.scrollY > 300 ? 'flex' : 'none';
            });

            /* Navbar hamburger */
            const ham = document.getElementById('hamburger');
            const nav = document.getElementById('navLinks');
            if (ham) {
                ham.addEventListener('click', () => {
                    ham.classList.toggle('active');
                    nav.classList.toggle('active');
                });
            }

            /* Theme switcher */
            const themeButtons = document.querySelectorAll('.theme-option');
            function setTheme(th) {
                document.body.setAttribute('data-theme', th);
                document.body.classList.toggle('light-mode', th === 'minimal');
                localStorage.setItem('theme', th);
                themeButtons.forEach(b => b.setAttribute('aria-pressed', String(b.dataset.theme === th)));
            }
            const savedTheme = localStorage.getItem('theme') || 'ocean';
            setTheme(savedTheme);
            themeButtons.forEach(b => b.addEventListener('click', () => setTheme(b.dataset.theme)));

            /* Cursor trail */
            const coords = { x: 0, y: 0 };
            const circles = document.querySelectorAll('.circle');
            circles.forEach(c => { c.x = 0; c.y = 0; });
            window.addEventListener('mousemove', e => {
                coords.x = e.pageX;
                coords.y = e.pageY - window.scrollY;
            });
            (function animate() {
                let x = coords.x, y = coords.y;
                circles.forEach((c, i) => {
                    c.style.left = `${x - 12}px`;
                    c.style.top = `${y - 12}px`;
                    c.style.transform = `scale(${(circles.length - i) / circles.length})`;
                    const n = circles[i + 1] || circles[0];
                    c.x = x; c.y = y;
                    x += (n.x - x) * 0.3;
                    y += (n.y - y) * 0.3;
                });
                requestAnimationFrame(animate);
            })();

            /* Utility */
            function escHTML(s) {
                return String(s).replace(/[&<>"']/g, m =>
                    ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m])
                );
            }
        });
    </script>

</body>

</html>