<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fossil Dig Â· Paleontology Excavation</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Atkinson Hyperlegible', 'Segoe UI', sans-serif;
            background-color: #2b5f3b;
            color: #f0e6d2;
        }
        #dig-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 50;
            background: rgba(70, 40, 20, 0.85);
            backdrop-filter: blur(12px);
            border: 2px solid #c99e6e;
            border-radius: 40px;
            padding: 14px 32px;
            display: flex;
            gap: 40px;
            border-left: 6px solid #e5b887;
            box-shadow: 0 0 40px rgba(200,120,50,0.3);
            pointer-events: none;
        }
        .dig-item {
            display: flex;
            flex-direction: column;
        }
        .dig-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            color: #e5c8a3;
            letter-spacing: 1px;
        }
        .dig-value {
            font-size: 1.6rem;
            font-weight: 600;
            background: linear-gradient(135deg, #fff3e0, #e5b887);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        #fossil-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(50, 30, 10, 0.85);
            backdrop-filter: blur(16px);
            border: 2px solid #b88b5a;
            border-radius: 48px;
            padding: 20px 32px;
            z-index: 50;
            border-right: 6px solid #e5b887;
            min-width: 260px;
            box-shadow: 0 15px 35px rgba(100,50,10,0.5);
        }
        .fossil-row {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 1rem;
            border-bottom: 1px solid #8b6b45;
            padding-bottom: 5px;
        }
        .fossil-label {
            color: #e5c8a3;
        }
        .fossil-value {
            font-weight: 600;
            color: #ffebc0;
        }
        .pulse-dig {
            width: 14px;
            height: 14px;
            background: #e5b887;
            border-radius: 50%;
            box-shadow: 0 0 30px #e5b887;
            animation: dig-pulse 2s infinite;
        }
        @keyframes dig-pulse {
            0% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); background: #ffd7a5; }
            100% { opacity: 0.6; transform: scale(1); }
        }
        #environment-tag {
            position: absolute;
            bottom: 30px;
            left: 30px;
            background: rgba(40, 60, 30, 0.8);
            backdrop-filter: blur(8px);
            border: 2px solid #6a994e;
            border-radius: 40px;
            padding: 12px 28px;
            z-index: 50;
            border-left: 4px solid #a7c957;
            color: #e9f5d9;
        }
        .flora-icon {
            display: inline-block;
            width: 12px;
            height: 12px;
            background: #6a994e;
            border-radius: 50%;
            margin-right: 8px;
            box-shadow: 0 0 15px #a7c957;
        }
        #expedition-stats {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background: rgba(60, 40, 20, 0.85);
            backdrop-filter: blur(8px);
            border: 2px solid #b88b5a;
            border-radius: 40px;
            padding: 16px 28px;
            z-index: 50;
            text-align: right;
            border-bottom: 4px solid #e5b887;
        }
        .glow-number {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ffebc0, #e5b887);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>
    <div id="dig-panel">
        <div class="dig-item">
            <span class="dig-label">site</span>
            <span class="dig-value">HELL CREEK</span>
        </div>
        <div class="dig-item">
            <span class="dig-label">formation</span>
            <span class="dig-value">MAASTRICHTIAN</span>
        </div>
        <div class="dig-item">
            <span class="dig-label">depth</span>
            <span class="dig-value" id="depth-dig">3.8</span><span style="font-size:1rem;">m</span>
        </div>
    </div>

    <div id="fossil-panel">
        <div style="display: flex; gap: 12px; align-items: center; margin-bottom: 16px;">
            <span class="pulse-dig"></span>
            <span style="font-weight: 600; font-size: 1.3rem;">ðŸ¦´ FOSSIL ASSEMBLAGE</span>
        </div>
        <div class="fossil-row">
            <span class="fossil-label">specimen</span>
            <span class="fossil-value">T. rex (MOR 1128)</span>
        </div>
        <div class="fossil-row">
            <span class="fossil-label">elements</span>
            <span class="fossil-value">femur, tibia, vertebrae</span>
        </div>
        <div class="fossil-row">
            <span class="fossil-label">completeness</span>
            <span class="fossil-value" id="completeness">47%</span>
        </div>
        <div class="fossil-row">
            <span class="fossil-label">age</span>
            <span class="fossil-value">66.2 Ma</span>
        </div>
        <div class="fossil-row">
            <span class="fossil-label">excavation</span>
            <span class="fossil-value">day 23</span>
        </div>
    </div>

    <div id="environment-tag">
        <span class="flora-icon"></span> <span>floodplain Â· metasequoia Â· horsetails</span>
    </div>

    <div id="expedition-stats">
        <div style="font-size:1rem;">â›º FIELD CREW</div>
        <div class="glow-number">12<span style="font-size:1rem;"> members</span></div>
        <div style="font-size:0.8rem;">tools: 8 Â· plaster: 14 boxes</div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';
        
        // --- Scene setup ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87c0d0); // sky blue
        scene.fog = new THREE.Fog(0x87c0d0, 30, 80);
        
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 200);
        camera.position.set(15, 8, 25);
        
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);
        
        const labelRenderer = new CSS2DRenderer();
        labelRenderer.setSize(window.innerWidth, window.innerHeight);
        labelRenderer.domElement.style.position = 'absolute';
        labelRenderer.domElement.style.top = '0';
        labelRenderer.domElement.style.left = '0';
        labelRenderer.domElement.style.pointerEvents = 'none';
        document.body.appendChild(labelRenderer.domElement);
        
        // --- Controls ---
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.autoRotate = false;
        controls.enableZoom = true;
        controls.maxPolarAngle = Math.PI / 2.2;
        controls.minDistance = 10;
        controls.maxDistance = 60;
        
        // --- Lighting ---
        const ambient = new THREE.AmbientLight(0x404c60);
        scene.add(ambient);
        
        const sunLight = new THREE.DirectionalLight(0xfff5e6, 1.2);
        sunLight.position.set(20, 30, 15);
        sunLight.castShadow = true;
        sunLight.shadow.mapSize.width = 1024;
        sunLight.shadow.mapSize.height = 1024;
        const d = 30;
        sunLight.shadow.camera.left = -d;
        sunLight.shadow.camera.right = d;
        sunLight.shadow.camera.top = d;
        sunLight.shadow.camera.bottom = -d;
        sunLight.shadow.camera.near = 1;
        sunLight.shadow.camera.far = 50;
        scene.add(sunLight);
        
        const fillLight = new THREE.PointLight(0x88aacc, 0.5);
        fillLight.position.set(-10, 10, 20);
        scene.add(fillLight);
        
        // --- Ground (dig site) ---
        const groundGeo = new THREE.CircleGeometry(30, 32);
        const groundMat = new THREE.MeshStandardMaterial({ color: 0x8b6b45, roughness: 0.8 });
        const ground = new THREE.Mesh(groundGeo, groundMat);
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = -0.5;
        ground.receiveShadow = true;
        scene.add(ground);
        
        // --- Dig pit (excavation area) ---
        const pitGeo = new THREE.CylinderGeometry(5, 5, 1, 32);
        const pitMat = new THREE.MeshStandardMaterial({ color: 0x5a3e2b });
        const pit = new THREE.Mesh(pitGeo, pitMat);
        pit.position.set(0, -1, 0);
        pit.receiveShadow = true;
        pit.castShadow = true;
        scene.add(pit);
        
        // --- Fossil bones (T. rex skeleton parts) ---
        function createBone(color = 0xeeddcc, pos, rot, scale) {
            const boneGeo = new THREE.CylinderGeometry(0.2, 0.2, 1, 6);
            const boneMat = new THREE.MeshStandardMaterial({ color: color, roughness: 0.4 });
            const bone = new THREE.Mesh(boneGeo, boneMat);
            bone.position.set(pos.x, pos.y, pos.z);
            bone.rotation.set(rot.x, rot.y, rot.z);
            bone.scale.set(scale.x, scale.y, scale.z);
            bone.castShadow = true;
            bone.receiveShadow = true;
            scene.add(bone);
            return bone;
        }
        
        // Femur (large)
        createBone(0xeeddcc, new THREE.Vector3(0.5, -0.4, 1.2), new THREE.Vector3(0.2, 0.5, 0.3), new THREE.Vector3(1.2, 2.5, 1.2));
        // Tibia
        createBone(0xeeddcc, new THREE.Vector3(-0.8, -0.5, 0.5), new THREE.Vector3(0.4, 0.8, 0.1), new THREE.Vector3(1.0, 2.0, 1.0));
        // Vertebrae (several)
        for (let i = 0; i < 5; i++) {
            createBone(0xddccbb, new THREE.Vector3(0.3 + i*0.4, -0.3, -0.5), new THREE.Vector3(0.1, i*0.2, 0.1), new THREE.Vector3(0.6, 0.8, 0.6));
        }
        // Ribs
        for (let i = 0; i < 4; i++) {
            const bone = createBone(0xccbbaa, new THREE.Vector3(-0.2 + i*0.5, -0.2, -1.0), new THREE.Vector3(0.5, 0.2, 0.5), new THREE.Vector3(0.4, 1.5, 0.4));
        }
        
        // --- Excavation tools ---
        const toolGroup = new THREE.Group();
        
        // Shovel
        const shovelHandle = new THREE.CylinderGeometry(0.1, 0.1, 2);
        const shovelMat = new THREE.MeshStandardMaterial({ color: 0x8b5a2b });
        const handle = new THREE.Mesh(shovelHandle, shovelMat);
        handle.position.set(2, 0.5, 2);
        handle.rotation.z = 0.3;
        handle.castShadow = true;
        scene.add(handle);
        
        // Brush
        const brushGeo = new THREE.BoxGeometry(0.2, 0.2, 1);
        const brushMat = new THREE.MeshStandardMaterial({ color: 0xa55d3d });
        const brush = new THREE.Mesh(brushGeo, brushMat);
        brush.position.set(-2, 0.2, 2.5);
        brush.rotation.y = 0.5;
        brush.castShadow = true;
        scene.add(brush);
        
        // --- Vegetation (simple cones) ---
        for (let i = 0; i < 40; i++) {
            const x = (Math.random() - 0.5) * 25;
            const z = (Math.random() - 0.5) * 25;
            if (Math.sqrt(x*x + z*z) < 6) continue; // keep dig area clear
            
            const height = 0.5 + Math.random() * 1.5;
            const plantGeo = new THREE.ConeGeometry(0.3, height, 6);
            const plantMat = new THREE.MeshStandardMaterial({ color: 0x3a5f0b });
            const plant = new THREE.Mesh(plantGeo, plantMat);
            plant.position.set(x, -0.5 + height/2, z);
            plant.castShadow = true;
            plant.receiveShadow = true;
            scene.add(plant);
        }
        
        // --- Some trees (cycads) ---
        for (let i = 0; i < 15; i++) {
            const x = (Math.random() - 0.5) * 30;
            const z = (Math.random() - 0.5) * 30;
            if (Math.sqrt(x*x + z*z) < 7) continue;
            
            const trunkGeo = new THREE.CylinderGeometry(0.2, 0.3, 2);
            const trunkMat = new THREE.MeshStandardMaterial({ color: 0x8b5a2b });
            const trunk = new THREE.Mesh(trunkGeo, trunkMat);
            trunk.position.set(x, 0.5, z);
            trunk.castShadow = true;
            trunk.receiveShadow = true;
            scene.add(trunk);
            
            const frondGeo = new THREE.ConeGeometry(0.8, 1.0, 5);
            const frondMat = new THREE.MeshStandardMaterial({ color: 0x2d5a27 });
            const frond = new THREE.Mesh(frondGeo, frondMat);
            frond.position.set(x, 1.5, z);
            frond.castShadow = true;
            scene.add(frond);
        }
        
        // --- Tents (field camp) ---
        const tentGroup = new THREE.Group();
        tentGroup.position.set(8, -0.5, 8);
        
        const tentBase = new THREE.CylinderGeometry(1.5, 1.5, 0.2, 6);
        const baseMat = new THREE.MeshStandardMaterial({ color: 0x8b4513 });
        const base = new THREE.Mesh(tentBase, baseMat);
        base.position.y = 0.1;
        base.receiveShadow = true;
        tentGroup.add(base);
        
        const tentCone = new THREE.ConeGeometry(1.4, 1.5, 6);
        const tentMat = new THREE.MeshStandardMaterial({ color: 0xd2b48c });
        const tent = new THREE.Mesh(tentCone, tentMat);
        tent.position.y = 0.85;
        tent.castShadow = true;
        tent.receiveShadow = true;
        tentGroup.add(tent);
        
        scene.add(tentGroup);
        
        // Second tent
        const tent2 = tentGroup.clone();
        tent2.position.set(-6, -0.5, 10);
        scene.add(tent2);
        
        // --- Field jackets and crates ---
        const crateGeo = new THREE.BoxGeometry(1, 0.5, 1);
        const crateMat = new THREE.MeshStandardMaterial({ color: 0x8b5a2b });
        const crate = new THREE.Mesh(crateGeo, crateMat);
        crate.position.set(5, -0.25, 12);
        crate.castShadow = true;
        crate.receiveShadow = true;
        scene.add(crate);
        
        // --- Labels ---
        const femurDiv = document.createElement('div');
        femurDiv.textContent = 'ðŸ¦´ femur';
        femurDiv.style.background = '#332211';
        femurDiv.style.color = '#e5c8a3';
        femurDiv.style.border = '1px solid #b88b5a';
        femurDiv.style.borderRadius = '20px';
        femurDiv.style.padding = '2px 12px';
        femurDiv.style.fontSize = '12px';
        const femurLabel = new CSS2DObject(femurDiv);
        femurLabel.position.set(0.5, 0.5, 1.2);
        scene.add(femurLabel);
        
        const tibiaDiv = document.createElement('div');
        tibiaDiv.textContent = 'ðŸ¦´ tibia';
        tibiaDiv.style.background = '#332211';
        tibiaDiv.style.color = '#e5c8a3';
        tibiaDiv.style.border = '1px solid #b88b5a';
        tibiaDiv.style.borderRadius = '20px';
        tibiaDiv.style.padding = '2px 12px';
        tibiaDiv.style.fontSize = '12px';
        const tibiaLabel = new CSS2DObject(tibiaDiv);
        tibiaLabel.position.set(-0.8, 0.3, 0.5);
        scene.add(tibiaLabel);
        
        // --- Animate ---
        let time = 0;
        
        function animate() {
            requestAnimationFrame(animate);
            
            time += 0.01;
            
            // Update depth display
            const depth = 3.8 + Math.sin(time * 0.3) * 0.2;
            document.getElementById('depth-dig').innerText = depth.toFixed(1);
            
            // Update completeness
            const comp = 47 + Math.sin(time * 0.5) * 2;
            document.getElementById('completeness').innerText = Math.floor(comp) + '%';
            
            controls.update();
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }
        
        animate();
        
        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>